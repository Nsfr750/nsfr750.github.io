---
lang: ja
lang-niv: fonto
lang-ref: 015-jbk
layout: doc
order: 6
title: 'MSR605 カードリーダー/ライター'
---

# MSR605 カードリーダー/ライター - ユーザーガイド

MSR605カードリーダー/ライターのユーザーガイドへようこそ！このドキュメントでは、磁気ストライプカードの読み取りと書き込みを行うためのアプリケーションの使い方について説明します。

## 目次
1. [インストール](#インストール)
2. [はじめに](#はじめに)
3. [カードの読み取り](#カードの読み取り)
4. [カードへの書き込み](#カードへの書き込み)
5. [設定](#設定)
6. [トラブルシューティング](#トラブルシューティング)

## インストール

### Windows
1. [リリースページ](https://github.com/Nsfr750/MSR605/releases)から最新のインストーラーをダウンロード
2. インストーラーを実行し、画面の指示に従う
3. MSR605デバイスを利用可能なUSBポートに接続
4. スタートメニューまたはデスクトップのショートカットからアプリケーションを起動

### Linux/macOS
1. Python 3.8以上がインストールされていることを確認
2. 必要な依存関係をインストール:
   ```bash
   pip install -r requirements.txt
   ```
3. アプリケーションを実行:
   ```bash
   python main.py
   ```

## はじめに

### デバイスの接続
1. MSR605デバイスをUSBケーブルでコンピュータに接続
2. アプリケーションが自動的にデバイスを検出するはずです
3. 接続が成功するとステータスバーに「デバイス接続済み」と表示されます

### メインインターフェース
- **カードデータ表示**: カードから読み取ったデータを表示
- **トラック選択**: 読み取り/書き込みするトラックを選択（1、2、3）
- **操作ボタン**: 読み取り、書き込み、クリア機能
- **ステータスバー**: 接続状態と操作結果を表示

## カードの読み取り

1. 磁気ストライプカードをリーダーに挿入
2. 「読み取り」ボタンをクリック
3. カードデータがメインウィンドウに表示されます
4. データを保存するには、「ファイル」>「名前を付けて保存...」をクリック

## カードへの書き込み

1. 書き込み可能な磁気ストライプカードをライターに挿入
2. 書き込むデータを適切なトラックフィールドに入力または貼り付け
3. 書き込むトラックを選択
4. 「書き込み」ボタンをクリック
5. ステータスバーに操作結果が表示されます

## カードフォーマットのサポート

このアプリケーションは、ISO 7811とISO 7813の2つの主要な磁気カード規格をサポートしています。適切なカードの読み取りと書き込みを行うためには、これらのフォーマットを理解することが重要です。

### ISO 7811

ISO 7811は、磁気ストライプ付き識別カードの国際規格です。以下を定義しています：

- **トラック1**: 英数字データ（最大79文字）
  - フォーマット: `%[フォーマットコード][プライマリアカウント番号]^[名前]^[有効期限][サービスコード][任意データ]?`
  - 例: `%B1234567890123456^カードホルダー/名前^24011234567890123456789?`

- **トラック2**: 数字データ（最大40文字）
  - フォーマット: `;[プライマリアカウント番号]=[有効期限][サービスコード][任意データ]?`
  - 例: `;1234567890123456=24011234567890123456?`

- **トラック3**: 読み書き可能（あまり使用されない）
  - 主に数値データ
  - 金融取引や値の更新に使用

### ISO 7813

ISO 7813は、金融取引カード向けのISO 7811のサブセットです。主な違い：

- **トラック1**: より厳格なフォーマット
  - フォーマットコードは'B'（銀行用）でなければならない
  - 特定のデータ要素に対して固定長
  - 例: `%B1234567890123456^カードホルダー/名前^24011234567890123456789?`

- **トラック2**: ISO 7811と同様だが、特定の検証ルールあり
  - 例: `;1234567890123456=24011234567890123456?`

### 正しいフォーマットの選択

1. **設定** > **カードフォーマット**に移動
2. 以下から選択:
   - **自動検出**（デフォルト）: カードフォーマットを自動検出
   - **ISO 7811**: 汎用カード用
   - **ISO 7813**: 金融取引カード用
3. **適用**をクリックして設定を保存

## カードへの書き込み

1. 書き込むトラックを選択
2. 適切なカードフォーマット（ISO 7811またはISO 7813）を選択
3. 選択したフォーマットに従って適切なトラックフィールドにデータを入力
4. 「書き込み」ボタンをクリック
5. アプリケーションがデータを検証し、書き込み操作を実行
6. 操作ステータスがステータスバーに表示されます

## 設定

### デバイス設定
- **ボーレート**: 通信速度を調整（デフォルト: 9600）
- **パリティ**: パリティを設定（なし、偶数、奇数、マーク、スペース）
- **データビット**: データビット数を設定（デフォルト: 8）
- **ストップビット**: ストップビット数を設定（デフォルト: 1）

### アプリケーション設定
- **デバイスの自動検出**: 自動検出の有効/無効
- **最小化して起動**: システムトレイに最小化して起動
- **ログの保存**: 操作のログをファイルに記録

## トラブルシューティング

### よくある問題

#### デバイスが検出されない
- デバイスがUSBポートに正しく接続されていることを確認
- 別のUSBポートを試す
- デバイスマネージャーでデバイスが認識されているか確認
- アプリケーションを再起動

#### 読み取り/書き込みが失敗する
- カードが正しく挿入されていることを確認
- カードの磁気ストライプを清掃
- カードが書き込み禁止になっていないか確認
- トラック構成がカードフォーマットと一致しているか確認

#### アプリケーションがクラッシュする
- 最新バージョンを使用していることを確認
- ログファイルでエラーの詳細を確認
- アプリケーションを再インストール

# MSR605 カードリーダー/ライター - APIドキュメント

このドキュメントでは、アプリケーションの拡張や統合を希望する開発者向けに、MSR605カードリーダー/ライターのAPIに関する詳細な情報を提供します。

## 目次
1. [概要](#概要)
2. [コアモジュール](#コアモジュール)
3. [デバイス通信](#デバイス通信)
4. [カード操作](#カード操作)
5. [データ形式](#データ形式)
6. [エラーハンドリング](#エラーハンドリング)
7. [例](#例)

## 概要

MSR605 APIは、磁気ストライプカードリーダー/ライターと対話するためのPythonインターフェースを提供します。このAPIは、すべてのデバイス機能にアクセスしながらも使いやすいように設計されています。

## コアモジュール

### `msr605`
主要な機能を含むメインモジュールです。

#### `MSR605` クラス
```python
class MSR605:
    def __init__(self, port=None, baudrate=9600, timeout=1):
        """MSR605デバイス接続を初期化します。
        
        引数:
            port (str, オプション): シリアルポート名。Noneの場合は自動検出を試みます。
            baudrate (int, オプション): 通信ボーレート。デフォルトは9600。
            timeout (int, オプション): 読み取りタイムアウト（秒）。デフォルトは1。
        """
        pass
    
    def connect(self):
        """デバイスへの接続を確立します。"""
        pass
    
    def disconnect(self):
        """デバイスとの接続を閉じます。"""
        pass
    
    def is_connected(self):
        """デバイスが接続されているかどうかを確認します。
        
        戻り値:
            bool: 接続されている場合はTrue、それ以外はFalse。
        """
        pass
```

## カードフォーマットの詳細

### サポートされている規格
- **ISO/IEC 7811**: 汎用磁気ストライプカード
- **ISO/IEC 7813**: 金融取引カード（7811のサブセット）

#### トラック仕様

## トラブルシューティング

### エラーが発生しました
1. エラーメッセージを確認してください
2. ログファイルを確認してください
3. デバイスを再接続してください
4. エラーの詳細を添えてサポートに連絡してください

### 「デバイスが見つかりません」エラーが表示される
1. デバイスを切断して再接続してください
2. 別のUSBポートをお試しください

### 高度な機能

#### データの視覚化
1. カードを読み取ります
2. 高度な機能ウィンドウで「視覚化」タブをクリック
3. 各トラックの生成された視覚化を表示

### カスタマイズ
