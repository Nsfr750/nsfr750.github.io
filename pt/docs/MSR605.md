---
lang: pt
lang-niv: fonto
lang-ref: 015-jbk
layout: doc
order: 6
title: 'Leitor/Gravador de Cartões MSR605'
---

# Leitor/Gravador de Cartões MSR605 - Guia do Usuário

Bem-vindo ao guia do usuário do Leitor/Gravador de Cartões MSR605! Este documento irá ajudá-lo a começar a usar o aplicativo para ler e gravar em cartões de tarja magnética.

## Índice
1. [Instalação](#instalação)
2. [Primeiros Passos](#primeiros-passos)
3. [Leitura de Cartões](#leitura-de-cartões)
4. [Gravação de Cartões](#gravação-de-cartões)
5. [Configuração](#configuração)
6. [Solução de Problemas](#solução-de-problemas)
7. [Formatos de Cartão](#formatos-de-cartão)
8. [Recursos Avançados](#recursos-avançados)
9. [Perguntas Frequentes](#perguntas-frequentes)

## Instalação

### Windows
1. Baixe o instalador mais recente na página de [Lançamentos](https://github.com/Nsfr750/MSR605/releases)
2. Execute o instalador e siga as instruções na tela
3. Conecte seu dispositivo MSR605 a uma porta USB disponível
4. Inicie o aplicativo pelo Menu Iniciar ou atalho na área de trabalho

### Linux/macOS
1. Certifique-se de ter o Python 3.8+ instalado
2. Instale as dependências necessárias:
   ```bash
   pip install -r requirements.txt
   ```
3. Execute o aplicativo:
   ```bash
   python main.py
   ```

## Primeiros Passos

### Conectando o Dispositivo
1. Conecte seu dispositivo MSR605 ao computador usando o cabo USB
2. O aplicativo deve detectar o dispositivo automaticamente
3. A barra de status mostrará "Dispositivo Conectado" quando bem-sucedido

### Interface Principal
- **Exibição de Dados**: Mostra os dados lidos do cartão
- **Seleção de Faixas**: Escolha quais faixas ler/gravar (1, 2 e/ou 3)
- **Botões de Ação**: Funções de Ler, Gravar e Limpar
- **Barra de Status**: Exibe o status da conexão e resultados das operações

## Leitura de Cartões

1. Insira um cartão de tarja magnética no leitor
2. Clique no botão "Ler"
3. Os dados do cartão serão exibidos na janela principal
4. Para salvar os dados, clique em "Arquivo" > "Salvar Como..."

## Gravação de Cartões

1. Insira um cartão de tarja magnética gravável no gravador
2. Digite ou cole os dados que deseja gravar nos campos de faixa apropriados
3. Selecione em quais faixas deseja gravar
4. Clique no botão "Gravar"
5. A barra de status mostrará o resultado da operação

## Formatos de Cartão

O aplicativo suporta dois padrões principais de cartões magnéticos: ISO 7811 e ISO 7813. Entender estes formatos é crucial para operações adequadas de leitura e gravação.

### ISO 7811

ISO 7811 é o padrão internacional para cartões de identificação com tarja magnética. Define:

- **Faixa 1**: Dados alfanuméricos (até 79 caracteres)
  - Formato: `%[código de formato][número da conta principal]^[nome]^[data de validade][código de serviço][dados discricionários]?`
  - Exemplo: `%B1234567890123456^TITULAR/CARTAO^24011234567890123456789?`

- **Faixa 2**: Dados numéricos (até 40 caracteres)
  - Formato: `;[número da conta principal]=[data de validade][código de serviço][dados discricionários]?`
  - Exemplo: `;1234567890123456=24011234567890123456?`

- **Faixa 3**: Capacidade de leitura/escrita (pouco utilizada)
  - Principalmente dados numéricos
  - Usada para transações financeiras e atualizações de valor

### ISO 7813

ISO 7813 é um subconjunto do ISO 7811 especificamente para cartões de transações financeiras. Principais diferenças:

- **Faixa 1**: Formato mais rígido
  - O código de formato deve ser 'B' (bancário)
  - Comprimentos de campo fixos para certos elementos de dados
  - Exemplo: `%B1234567890123456^TITULAR/CARTAO^24011234567890123456789?`

- **Faixa 2**: Similar ao ISO 7811 mas com regras de validação específicas
  - Exemplo: `;1234567890123456=24011234567890123456?`

### Selecionando o Formato Correto

1. Vá para **Configurações** > **Formato do Cartão**
2. Escolha entre:
   - **Detecção automática** (padrão): Detecta automaticamente o formato do cartão
   - **ISO 7811**: Para cartões de uso geral
   - **ISO 7813**: Para cartões de transações financeiras
3. Clique em **Aplicar** para salvar as configurações

## Configuração

### Configurações do Dispositivo
- **Taxa de Transmissão**: Ajusta a velocidade de comunicação (padrão: 9600)
- **Paridade**: Define a paridade (Nenhuma, Par, Ímpar, Marca, Espaço)
- **Bits de Dados**: Define o número de bits de dados (padrão: 8)
- **Bits de Parada**: Define o número de bits de parada (padrão: 1)

### Configurações do Aplicativo
- **Detecção Automática de Dispositivo**: Ativa/desativa a detecção automática de dispositivos
- **Iniciar Minimizado**: Inicia o aplicativo minimizado na bandeja do sistema
- **Salvar Logs**: Habilita o registro de operações em arquivo

## Solução de Problemas

### Problemas Comuns

#### Dispositivo Não Encontrado
- Verifique se o dispositivo está corretamente conectado à porta USB
- Tente uma porta USB diferente
- Verifique se o dispositivo aparece no Gerenciador de Dispositivos do sistema
- Reinicie o aplicativo

#### Falhas na Leitura/Gravação
- Verifique se o cartão está corretamente inserido
- Limpe a faixa magnética do cartão
- Verifique se o cartão não está protegido contra gravação
- Confirme se a configuração das faixas corresponde ao formato do cartão

#### Travamentos do Aplicativo
- Certifique-se de ter a versão mais recente instalada
- Verifique o arquivo de log para detalhes do erro
- Tente reinstalar o aplicativo

## Recursos Avançados

### Visualização de Dados

#### Visualização de Faixas
1. Leia um cartão ou carregue dados salvos
2. Clique na aba "Visualização" na janela de Recursos Avançados
3. Visualize as representações geradas para cada faixa

### Personalização

#### Modelos de Dados
Crie modelos personalizados para diferentes tipos de cartões:
1. Vá para **Modelos** > **Novo Modelo**
2. Defina os campos e formatos
3. Salve o modelo para uso futuro

## Perguntas Frequentes

### Como atualizar o driver do dispositivo?
1. Baixe o driver mais recente do site do fabricante
2. Abra o Gerenciador de Dispositivos
3. Localize o dispositivo MSR605
4. Clique com o botão direito e selecione "Atualizar driver"
5. Siga as instruções na tela

### O que fazer se o aplicativo travar?
1. Feche o aplicativo
2. Desconecte e reconecte o dispositivo
3. Reabra o aplicativo
4. Se o problema persistir, entre em contato com o suporte com os detalhes do erro

### Estou recebendo erros de "Dispositivo não encontrado"
1. Desconecte e reconecte o dispositivo
2. Tente uma porta USB diferente
3. Verifique se o dispositivo aparece no Gerenciador de Dispositivos
4. Reinstale os drivers, se necessário

## Documentação da API

### Módulos Principais

#### `msr605`
O módulo principal que contém a funcionalidade básica.

#### Classe `MSR605`
```python
class MSR605:
    def __init__(self, porta=None, velocidade=9600, tempo_espera=1):
        """Inicializa a conexão com o dispositivo MSR605.
        
        Args:
            porta (str, opcional): Nome da porta serial. Se None, tenta detecção automática.
            velocidade (int, opcional): Velocidade de comunicação em bauds. Padrão: 9600.
            tempo_espera (int, opcional): Tempo de espera da leitura em segundos. Padrão: 1.
        """
        pass
    
    def conectar(self):
        """Estabelece a conexão com o dispositivo."""
        pass
    
    def desconectar(self):
        """Fecha a conexão com o dispositivo."""
        pass
    
    def esta_conectado(self):
        """Verifica se o dispositivo está conectado.
        
        Returns:
            bool: True se estiver conectado, False caso contrário.
        """
        pass
    
    def ler_cartao(self, faixas=[1, 2, 3]):
        """Lê dados de um cartão de tarja magnética.
        
        Args:
            faixas (list, opcional): Lista de faixas para ler (1, 2, 3). Padrão: todas as faixas.
            
        Returns:
            dict: Dicionário contendo os dados das faixas com os números das faixas como chaves.
        """
        pass
    
    def gravar_cartao(self, dados_faixa, verificar=True):
        """Grava dados em um cartão de tarja magnética.
        
        Args:
            dados_faixa (dict): Dicionário com números de faixa como chaves e dados como valores.
            verificar (bool, opcional): Se deve verificar os dados gravados. Padrão: True.
            
        Returns:
            bool: True se a gravação foi bem-sucedida, False caso contrário.
        """
        pass
```

### Exemplos de Uso

#### Leitura Básica
```python
from msr605 import MSR605

# Inicializa e conecta ao dispositivo
dispositivo = MSR605()
dispositivo.conectar()

# Lê todas as faixas
dados = dispositivo.ler_cartao()
print(f"Faixa 1: {dados.get(1, 'Sem dados')}")
print(f"Faixa 2: {dados.get(2, 'Sem dados')}")
print(f"Faixa 3: {dados.get(3, 'Sem dados')}")

# Desconecta
dispositivo.desconectar()
```

#### Gravação Básica
```python
from msr605 import MSR605

# Inicializa e conecta ao dispositivo
dispositivo = MSR605()
dispositivo.conectar()

# Prepara os dados das faixas
dados_faixa = {
    1: "%B1234567890123456^TITULAR/CARTAO^25121010000000000000000000000000000?",
    2: ";1234567890123456=25121010000000000000?",
    3: ""  # Faixa 3 vazia
}

# Grava no cartão
sucesso = dispositivo.gravar_cartao(dados_faixa)
print(f"Gravação {'bem-sucedida' if sucesso else 'falhou'}")

# Desconecta
dispositivo.desconectar()
```

## Especificações Técnicas

### Especificações de Hardware
- **Interface**: USB 2.0
- **Velocidade de Leitura/Gravação**: Até 30 cm/s
- **Faixas**: 3 faixas (2 faixas de alta coercitividade, 1 faixa de baixa coercitividade)
- **Compatibilidade**: Conformidade com ISO 7810, 7811, 7813, 4909, 3554
- **Fonte de Alimentação**: Alimentado por USB (5V DC)
- **Temperatura de Operação**: 0°C a 50°C
- **Umidade**: 20% a 90% sem condensação
- **Dimensões**: 115mm x 75mm x 25mm
- **Peso**: Aproximadamente 100g

### Especificações de Software
- **Sistemas Operacionais Suportados**: Windows 7/8/10/11, Linux, macOS
- **Linguagens de Programação**: Python 3.8+
- **Bibliotecas Requeridas**: pyserial, pyusb
- **Formatos de Arquivo Suportados**: .txt, .bin, .eml, .json

## Suporte Técnico

### Recursos Adicionais
- [Manual do Usuário em PDF](https://github.com/Nsfr750/MSR605/blob/master/docs/manual_usuario.pdf)
- [Perguntas Frequentes](https://github.com/Nsfr750/MSR605/wiki/FAQ)
- [Fórum da Comunidade](https://github.com/Nsfr750/MSR605/discussions)

### Contato
- **Suporte por E-mail**: suporte@exemplo.com
- **Telefone de Suporte**: +55 (11) 98765-4321
- **Horário de Atendimento**: Segunda a Sexta, 9:00 - 18:00 (Brasília)

## Histórico de Versões

### Versão 1.2.0 (Atual)
- Adicionado suporte para macOS Big Sur e versões posteriores
- Melhorada a detecção automática de dispositivos
- Corrigido um bug na gravação de faixas de alta densidade
- Atualizadas as dependências de segurança

### Versão 1.1.0
- Adicionada interface gráfica do usuário
- Implementada verificação de gravação
- Melhorado o tratamento de erros
- Adicionada documentação da API

### Versão 1.0.0
- Versão inicial do software
- Suporte para leitura/gravação básica
- Interface de linha de comando
